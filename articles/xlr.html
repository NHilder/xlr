<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting started with xlr • xlr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with xlr">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">xlr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/xlr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NHilder/xlr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting started with xlr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/NHilder/xlr/blob/main/vignettes/xlr.Rmd" class="external-link"><code>vignettes/xlr.Rmd</code></a></small>
      <div class="d-none name"><code>xlr.Rmd</code></div>
    </div>

    
    
<p>xlr is designed to help with the analysis of survey data and conduct
modelling, and then export this information to <code>Excel</code> in an
easy and consistent way.</p>
<p>It is designed to help people with little R experience analyse survey
data quickly and easily. This includes functions to quickly analyse
multiple-response questions and block questions.</p>
<p>This package also provides a simple and easy to use interface with
<code>Excel</code>, building on the excellent work of the [openxlsx]
package. It is designed with ease of use in mind, at the expense of some
functionality of <code>openxlsx</code>.</p>
<p>This package relies extensively on the <a href="https://www.tidyverse.org/" class="external-link">tidyverse</a> and so we use many of
the same terms and concepts here.</p>
<p>There are three aspects to this package:</p>
<ol style="list-style-type: decimal">
<li><p>Functions to help with the analysis of survey complex survey
data.</p></li>
<li><p>Functions to help export this data to
<code>Excel</code>.</p></li>
<li><p>New <code>R</code> types to support consistent formatting in
<code>Excel</code>.</p></li>
</ol>
<div class="section level3">
<h3 id="data-clothes_opinions">Data: clothes_opinions<a class="anchor" aria-label="anchor" href="#data-clothes_opinions"></a>
</h3>
<p>To explore how to analyse complex data we’ll use the dataset
<code>clothes_opinions</code>. This dataset contains fake survey data
with peoples opinions on clothes as well as a series of demographic
characteristics. It is documented in <code><a href="../reference/clothes_opinions.html">?clothes_opinions</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">clothes_opinions</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1000   20</span></span>
<span><span class="va">clothes_opinions</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,000 × 20</span></span></span>
<span><span class="co">#&gt;   weight group gender gender2      age age_group Q1_1    Q1_2    Q1_3    Q1_4   </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int+l&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int+l&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int+l&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int+l&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   <span style="text-decoration: underline;">1</span>072 a     female 2<span style="color: #949494;"> [female]</span>    25 18-30     1<span style="color: #949494;"> [Str…</span> 5<span style="color: #949494;"> [Str…</span> 5<span style="color: #949494;"> [Str…</span> 2<span style="color: #949494;"> [Dis…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    219 a     female 2<span style="color: #949494;"> [female]</span>    64 51-65     3<span style="color: #949494;"> [Neu…</span> 1<span style="color: #949494;"> [Str…</span> 2<span style="color: #949494;"> [Dis…</span> 2<span style="color: #949494;"> [Dis…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>   <span style="text-decoration: underline;">1</span>187 a     male   1<span style="color: #949494;"> [male]</span>      35 31-40     4<span style="color: #949494;"> [Agr…</span> 3<span style="color: #949494;"> [Neu…</span> 5<span style="color: #949494;"> [Str…</span> 1<span style="color: #949494;"> [Str…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   <span style="text-decoration: underline;">1</span>860 a     male   1<span style="color: #949494;"> [male]</span>      55 51-65     4<span style="color: #949494;"> [Agr…</span> 1<span style="color: #949494;"> [Str…</span> 2<span style="color: #949494;"> [Dis…</span> 2<span style="color: #949494;"> [Dis…</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 996 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 10 more variables: Q2_1 &lt;chr&gt;, Q2_2 &lt;chr&gt;, Q2_3 &lt;chr&gt;, Q2_4 &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Q2_5 &lt;chr&gt;, Q2_6 &lt;chr&gt;, Q3_1 &lt;dbl+lbl&gt;, Q3_2 &lt;dbl+lbl&gt;, Q3_3 &lt;dbl+lbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Q3_other &lt;chr&gt;</span></span></span></code></pre></div>
<p><code>clothes_opinions</code> is a <code>tibble</code> a adapted type
of <code>data.frame</code>. You can learn more about tibbles at <a href="https://tibble.tidyverse.org/" class="external-link">https://tibble.tidyverse.org</a>.</p>
<p>It was designed to mimic data initially saved as a <code>.sav</code>
file and imported with <code>haven::import_spss()</code>. Data with this
form can easily be exported from major survey platforms such as <a href="https://www.qualtrics.com/" class="external-link">Qualtrics</a>, and includes useful
information such as question labels which xlr functions can utilise
automatically.</p>
</div>
<div class="section level3">
<h3 id="analysing-survey-data">Analysing survey data<a class="anchor" aria-label="anchor" href="#analysing-survey-data"></a>
</h3>
<p>There are three main functions to analyse survey data:</p>
<ul>
<li><p><code><a href="../reference/build_table.html">build_table()</a></code> which creates 1, 2, 3, … -way
tables.</p></li>
<li><p><code><a href="../reference/build_mtable.html">build_mtable()</a></code> which creates 1, 2, 3, … -way tables
for multiple response questions.</p></li>
<li><p><code><a href="../reference/build_qtable.html">build_qtable()</a></code> which creates 1, 2, 3, … -way tables
for a <strong>block</strong> of questions.</p></li>
</ul>
<p>We will start by introducing <code><a href="../reference/xlr_table.html">xlr_table()</a></code> and go through
all of its functionality. This functionality is similar for
<code><a href="../reference/build_mtable.html">build_mtable()</a></code> and <code><a href="../reference/build_qtable.html">build_qtable()</a></code>.</p>
<div class="section level4">
<h4 id="build_table">build_table()<a class="anchor" aria-label="anchor" href="#build_table"></a>
</h4>
<p>This function provides roughly the same functionality as base R’s
<code><a href="https://rdrr.io/r/base/table.html" class="external-link">table()</a></code> except it provides a lot more support for easy use.
Like all functions in this package, we follow the convention of the
first argument is the data.frame (or tibble) that you want to work on.
The second argument are the columns we want to build a table with, and
the remainder are options for <code><a href="../reference/build_table.html">build_table()</a></code>.</p>
<p>Let’s first calculate the number of people of each gender in
<code>clothes_opinions</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="va">gender2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A xlr_table: 3 x 3</span></span></span>
<span><span class="co">#&gt;   gender2          N Percent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_pct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> male           461     46%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> female         464     46%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> non-binary      75      8%</span></span></code></pre></div>
<p>You can see that we have outputted a table which shows the number of
people and the percentage of each gender in our data set.</p>
<p>You can easily create two or three way tables by passing additional
columns to the <code>cols</code> argument:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="va">gender2</span><span class="op">)</span>,</span>
<span>              table_title <span class="op">=</span> <span class="st">"Gender by age make up of clothing opinion data"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Gender by age make up of clothing opinion data</span> <span style="color: #00BBBB;">──────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A xlr_table: 12 x 4</span></span></span>
<span><span class="co">#&gt;   age_group gender2          N Percent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_pct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 18-30     male           116     46%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 18-30     female         118     47%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 18-30     non-binary      18      7%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 31-40     male            96     48%</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more rows</span></span></span>
<span></span>
<span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="va">gender2</span>, <span class="va">Q1_1</span><span class="op">)</span>,</span>
<span>              table_title <span class="op">=</span> <span class="st">"Responses to Q1_1 by age and gender"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Responses to Q1_1 by age and gender</span> <span style="color: #00BBBB;">─────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A xlr_table: 60 x 5</span></span></span>
<span><span class="co">#&gt;   age_group gender2  Q1_1                    N Percent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_pct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 18-30     male     Strongly Disagree      18     16%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 18-30     male     Disagree               21     18%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 18-30     male     Neutral                26     22%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 18-30     male     Agree                  22     19%</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 56 more rows</span></span></span></code></pre></div>
<p>The <code>cols</code> argument uses <strong>tidy selections</strong>
to select the columns we want to make a table with. See <a href="https://dplyr.tidyverse.org/reference/dplyr_tidy_select.html" class="external-link">&lt;tidy-select&gt;</a>
for more details on the selectors. This should be familiar for people
who use dplyr verbs.</p>
<p>The data returns has a <strong>long format</strong> by default.
Currently wide table table is unsupported but may be included in a
future update.</p>
<div class="section level5">
<h5 id="introduction-to-xlr_table">Introduction to xlr_table()<a class="anchor" aria-label="anchor" href="#introduction-to-xlr_table"></a>
</h5>
<p>You can also see that it has a special type <code><a href="../reference/xlr_table.html">xlr_table()</a></code>.
This is a S3 class defined by xlr to help output the data to
<code>Excel</code>. It contains the table data, a table title and a
footnote, as well as hidden data to help format the table in
<code>Excel</code>. You can learn more about <code><a href="../reference/xlr_table.html">xlr_table()</a></code> in
the vignette <code>to do</code>.</p>
<p>You can directly pass a title and a footnote to
<code><a href="../reference/build_table.html">build_table()</a></code> by passing them as arguments to
<code><a href="../reference/build_table.html">build_table()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="va">gender2</span>,</span>
<span>              table_title <span class="op">=</span> <span class="st">"Gender make up of clothing opinion data"</span>,</span>
<span>              footnote <span class="op">=</span> <span class="st">"This shows that the data has a representative sample."</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Gender make up of clothing opinion data</span> <span style="color: #00BBBB;">─────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A xlr_table: 3 x 3</span></span></span>
<span><span class="co">#&gt;   gender2          N Percent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_pct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> male           461     46%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> female         464     46%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> non-binary      75      8%</span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">This shows that the data has a representative sample.</span></span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="labels-in-xlr">Labels in xlr<a class="anchor" aria-label="anchor" href="#labels-in-xlr"></a>
</h5>
<p>Now if you were paying close attention, you may have noticed that
<code>clothes_opinions$gender2</code> went from being
<code>haven_labelled</code> to a <code><a href="../reference/xlr_vector.html">xlr_vector()</a></code>. A
<code>xlr_vector</code> is a wrapper around other types (see below for
more details), and the base type is <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>. All
<code>build_*</code> functions will convert this data automatically, as
well as pull information on the labels. See <code>haven</code>’s
documentation for more details about the labelled type: <a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link uri">https://haven.tidyverse.org/reference/labelled.html</a>.</p>
<p>Additionally, if your data is labelled, you can pull out the question
label metadata automatically and include it in the footnote by
specifying <code>use_questions = TRUE</code>. Columns that don’t have a
label are ignored.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="va">gender2</span><span class="op">)</span>,</span>
<span>              table_title <span class="op">=</span> <span class="st">"Gender by age make up of clothing opinion data"</span>,</span>
<span>              use_question <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Gender by age make up of clothing opinion data</span> <span style="color: #00BBBB;">──────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A xlr_table: 12 x 4</span></span></span>
<span><span class="co">#&gt;   age_group gender2          N Percent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_pct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 18-30     male           116     46%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 18-30     female         118     47%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 18-30     non-binary      18      7%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 31-40     male            96     48%</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more rows</span></span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">Questions</span></span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">The gender of the participant</span></span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="weights">Weights<a class="anchor" aria-label="anchor" href="#weights"></a>
</h5>
<p>Weights are supported, you only need to pass the column name for the
weights to the <code>wt</code> argument:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="va">gender2</span><span class="op">)</span>,</span>
<span>              table_title <span class="op">=</span> <span class="st">"Gender by age make up of clothing opinion data (weighted)"</span>,</span>
<span>              wt <span class="op">=</span> <span class="va">weight</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Gender by age make up of clothing opinion data (weighted)</span> <span style="color: #00BBBB;">───────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A xlr_table: 12 x 4</span></span></span>
<span><span class="co">#&gt;   age_group gender2            N Percent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;x_dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_pct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 18-30     male       122,277.0     47%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 18-30     female     118,532.0     46%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 18-30     non-binary  19,378.0      7%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 31-40     male        94,487.0     47%</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more rows</span></span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="missing-data">Missing data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h5>
<p><code><a href="../reference/build_table.html">build_table()</a></code> uses only complete cases by default, that
is for one of the columns we are if a row includes a single
<code>NA</code> it is removed from the table calculation. To include
<code>NA</code> values set <code>use_NA = TRUE</code>. This will mean
that <strong>ALL</strong> <code>NA</code>’s will be included in the
calculation of the table:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">age_group</span><span class="op">)</span>,</span>
<span>              table_title <span class="op">=</span> <span class="st">"Survey group by age make up of clothing opinion data"</span>,</span>
<span>              use_NA <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Survey group by age make up of clothing opinion data</span> <span style="color: #00BBBB;">────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A xlr_table: 15 x 4</span></span></span>
<span><span class="co">#&gt;   group    age_group       N Percent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_pct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> a        18-30         125     27%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> a        31-40          82     17%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> a        41-50         106     23%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> a        51-65         135     29%</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 11 more rows</span></span></span></code></pre></div>
<p>If you would like to include the <code>NA</code> values of only one
or some of the columns we recommend using <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter()</a></code>
as demonstrated below.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># remove all the rows where group is missing</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># by setting use_NA to true we keep the NA's from the age_group column</span></span>
<span>  <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">age_group</span><span class="op">)</span>,</span>
<span>              table_title <span class="op">=</span> <span class="st">"Survey group by age make up of clothing opinion data"</span>,</span>
<span>              use_NA <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Survey group by age make up of clothing opinion data</span> <span style="color: #00BBBB;">────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A xlr_table: 10 x 4</span></span></span>
<span><span class="co">#&gt;   group    age_group       N Percent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_pct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> a        18-30         125     27%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> a        31-40          82     17%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> a        41-50         106     23%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> a        51-65         135     29%</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 6 more rows</span></span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="build_mtable">build_mtable()<a class="anchor" aria-label="anchor" href="#build_mtable"></a>
</h4>
<p>This function is design to analyse multiple response questions in
survey data. To do so the data must be <strong>wide data</strong> with
<em>one</em> response per column (and the remaining responses NA). This
is how Qualtrics exports this data by default. The format is shown
below:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"Q2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,000 × 6</span></span></span>
<span><span class="co">#&gt;   Q2_1  Q2_2  Q2_3  Q2_4  Q2_5  Q2_6 </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Red   <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    Blue  Black Grey </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Red   <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    Black <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Red   <span style="color: #BB0000;">NA</span>    Green <span style="color: #BB0000;">NA</span>    Black Grey </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Red   <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    Black <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 996 more rows</span></span></span></code></pre></div>
<p>To create a table using the <code>mcol</code> argument to specify the
mutliple response columns you would like to create a table with:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/build_mtable.html">build_mtable</a></span><span class="op">(</span><span class="st">"Q2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A xlr_table: 6 x 4</span></span></span>
<span><span class="co">#&gt;   Q2             N N_group Percent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_pct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Black        897     995     90%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Blue         192     995     19%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Green        323     995     32%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Grey         494     995     50%</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more rows</span></span></span></code></pre></div>
<p>The output <code>N</code> count is the number of people that
responded to each multiple response option, the <code>N_group</code> is
the total number of people that responded to this question. The
<code>Percent</code> is the percentage of people that responded to each
of the options. As you can respond to multiple options this percentage
will likely not add up to 100.</p>
<p>Note, internally <code><a href="../reference/build_mtable.html">build_mtable()</a></code> uses
<code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">tidyselect::starts_with()</a></code> to select the columns that you
would like to build a table with, because of this you need to pass a
string to <code>mcol</code>.</p>
<p>You can cut your multiple response column by other data by passing
columns to the <code>cols</code> argument. As with
<code><a href="../reference/build_table.html">build_table()</a></code> it uses <code>&lt;tidy-eval&gt;</code> to
select the columns.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/build_mtable.html">build_mtable</a></span><span class="op">(</span>mcol <span class="op">=</span> <span class="st">"Q2"</span>,</span>
<span>               cols <span class="op">=</span> <span class="va">age_group</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A xlr_table: 24 x 5</span></span></span>
<span><span class="co">#&gt;   age_group Q2             N N_group Percent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_pct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 18-30     Black        228     250     91%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 18-30     Blue          38     250     15%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 18-30     Green         83     250     33%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 18-30     Grey         113     250     45%</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 20 more rows</span></span></span></code></pre></div>
<p>The <code>N_group</code> for this question is the number of people in
each age group that responded to the multiple response question.</p>
<p>It is common that a mulitple response column will include an
<em>other</em> response in a survey. This column needs to be removed
<em>before</em> you analyse the data with <code><a href="../reference/build_mtable.html">build_mtable()</a></code>.
We recommend using <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">dplyr::select</a></code> as demonstrated below:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Q3_other</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/build_mtable.html">build_mtable</a></span><span class="op">(</span>mcol <span class="op">=</span> <span class="st">"Q3"</span>,</span>
<span>               cols <span class="op">=</span> <span class="va">age_group</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A xlr_table: 12 x 5</span></span></span>
<span><span class="co">#&gt;   age_group Q3              N N_group Percent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_pct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 18-30     Earrings       77     216     36%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 18-30     Necklaces      54     216     25%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 18-30     Rings         193     216     89%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 31-40     Earrings       55     176     31%</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more rows</span></span></span></code></pre></div>
<p>As above you can see the <code><a href="../reference/build_mtable.html">build_mtable()</a></code> automatically
converts haven labelled data to a <code><a href="../reference/xlr_vector.html">xlr_vector()</a></code>.</p>
<div class="section level5">
<h5 id="multiple-multiple-response-columns">Multiple multiple response columns<a class="anchor" aria-label="anchor" href="#multiple-multiple-response-columns"></a>
</h5>
<p>You can pass up to <strong>two</strong> multiple response columns to
<code><a href="../reference/build_mtable.html">build_mtable()</a></code>, any more and we recommend filtering before
hand.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Q3_other</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/build_mtable.html">build_mtable</a></span><span class="op">(</span>mcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Q2"</span>,<span class="st">"Q3"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A xlr_table: 18 x 5</span></span></span>
<span><span class="co">#&gt;   Q2       Q3              N    N_Q2 Percent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_pct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Black    Earrings      264     897     29%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Black    Necklaces     180     897     20%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Black    Rings         693     897     77%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Blue     Earrings       59     192     31%</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 14 more rows</span></span></span></code></pre></div>
<p>The <code>N_group</code> is the number of people in each age_group
that responded to one of the options in age_group. <code>N</code> is the
number of people that responded to the multiple response question in
each group.</p>
</div>
</div>
<div class="section level4">
<h4 id="build_qtable">build_qtable()<a class="anchor" aria-label="anchor" href="#build_qtable"></a>
</h4>
<p>This function is designed to help analyse a block of questions. A
block of questions is where all the responses use the same scale (it is
usually a matrix question). The data should have the form:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"Q1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,000 × 4</span></span></span>
<span><span class="co">#&gt;   Q1_1                  Q1_2                  Q1_3               Q1_4           </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int+lbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int+lbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int+lbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int+lbl&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1<span style="color: #949494;"> [Strongly Disagree]</span> 5<span style="color: #949494;"> [Strongly Agree]</span>    5<span style="color: #949494;"> [Strongly Agree]</span> 2<span style="color: #949494;"> [Disagree]</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 3<span style="color: #949494;"> [Neutral]</span>           1<span style="color: #949494;"> [Strongly Disagree]</span> 2<span style="color: #949494;"> [Disagree]</span>       2<span style="color: #949494;"> [Disagree]</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 4<span style="color: #949494;"> [Agree]</span>             3<span style="color: #949494;"> [Neutral]</span>           5<span style="color: #949494;"> [Strongly Agree]</span> 1<span style="color: #949494;"> [Strongly Di…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 4<span style="color: #949494;"> [Agree]</span>             1<span style="color: #949494;"> [Strongly Disagree]</span> 2<span style="color: #949494;"> [Disagree]</span>       2<span style="color: #949494;"> [Disagree]</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 996 more rows</span></span></span></code></pre></div>
<p>To analyse a question block, you need to pass a
<code>&lt;tidy-eval&gt;</code> selection to the function to select all
columns in the question block. See we pass the same statement we made in
the select statement above.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/build_qtable.html">build_qtable</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"Q1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A xlr_table: 20 x 4</span></span></span>
<span><span class="co">#&gt;   `Question Block`       value                   N Percent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_pct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Pants are good to wear Strongly Disagree     180     18%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Pants are good to wear Disagree              194     20%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Pants are good to wear Neutral               204     21%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Pants are good to wear Agree                 205     21%</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 16 more rows</span></span></span>
<span></span>
<span><span class="co"># You can also select the columns directly</span></span>
<span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/build_qtable.html">build_qtable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Q1_1</span>,<span class="va">Q1_2</span>,<span class="va">Q1_3</span>,<span class="va">Q1_4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A xlr_table: 20 x 4</span></span></span>
<span><span class="co">#&gt;   `Question Block`       value                   N Percent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_pct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Pants are good to wear Strongly Disagree     180     18%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Pants are good to wear Disagree              194     20%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Pants are good to wear Neutral               204     21%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Pants are good to wear Agree                 205     21%</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 16 more rows</span></span></span></code></pre></div>
<p>You can cut all the columns in the question block by another
column(s) by specifying the <code>cols</code> argument. As with
<code><a href="../reference/build_table.html">build_table()</a></code> it uses <code>&lt;tidy-eval&gt;</code> to
select the columns.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/build_qtable.html">build_qtable</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"Q1"</span><span class="op">)</span>,</span>
<span>               <span class="va">gender2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A xlr_table: 60 x 5</span></span></span>
<span><span class="co">#&gt;   gender2  `Question Block`       value                   N Percent</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_pct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> male     Pants are good to wear Strongly Disagree      75     17%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> male     Pants are good to wear Disagree               96     21%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> male     Pants are good to wear Neutral                97     21%</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> male     Pants are good to wear Agree                  89     20%</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 56 more rows</span></span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="xlr_table-xlr-types-and-writing-to-excel">xlr_table(), xlr types and writing to <code>Excel</code><a class="anchor" aria-label="anchor" href="#xlr_table-xlr-types-and-writing-to-excel"></a>
</h3>
<p>A key part of the xlr is to export data to <code>Excel</code> in an
easy, and user friendly way. The workhorse function in this scenario is
<code><a href="../reference/xlr_table.html">xlr_table()</a></code>, and if you like the default options is meant
to be the function that you will mostly use.</p>
<p>A <code><a href="../reference/xlr_table.html">xlr_table()</a></code> is a <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble::tibble()</a></code> with an
optional title, and footnote, as well as a number of formatting
options.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/xlr_table.html">xlr_table</a></span><span class="op">(</span><span class="st">"This is a title"</span>,</span>
<span>             <span class="st">"this is a footnote with extra information"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">This is a title</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A xlr_table: 1000 x 20</span></span></span>
<span><span class="co">#&gt;    weight group    gender   gender2     age age_group    Q1_1   Q1_2  Q1_3  Q1_4</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_vctr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;x_int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_in&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_i&gt;</span> <span style="color: #949494; font-style: italic;">&lt;x_i&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   1,072 a        female      2.00      25 18-30           1      5     5     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     219 a        female      2.00      64 51-65           3      1     2     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>   1,187 a        male        1.00      35 31-40           4      3     5     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   1,860 a        male        1.00      55 51-65           4      1     2     2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 996 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 10 more variables: Q2_1 &lt;x_vctr&gt;, Q2_2 &lt;x_vctr&gt;, Q2_3 &lt;x_vctr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Q2_4 &lt;x_vctr&gt;, Q2_5 &lt;x_vctr&gt;, Q2_6 &lt;x_vctr&gt;, Q3_1 &lt;x_dbl&gt;, Q3_2 &lt;x_dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Q3_3 &lt;x_dbl&gt;, Q3_other &lt;x_vctr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">this is a footnote with extra information</span></span></span></code></pre></div>
<p>When you call <code><a href="../reference/xlr_table.html">xlr_table()</a></code> it converts the elements of
your table to different <code>xlr</code> types.</p>
<div class="section level4">
<h4 id="types">Types<a class="anchor" aria-label="anchor" href="#types"></a>
</h4>
<p>xlr types are defined to help with the formatting of columns when
they are output to <code>Excel</code>. There are four difference types
defined in xlr:</p>
<ul>
<li><p><code><a href="../reference/xlr_numeric.html">xlr_numeric()</a></code> to format doubles neatly.</p></li>
<li><p><code><a href="../reference/xlr_integer.html">xlr_integer()</a></code> to format integer data
neatly.</p></li>
<li><p><code><a href="../reference/xlr_percent.html">xlr_percent()</a></code> to format numeric data as a
percentage.</p></li>
<li><p><code><a href="../reference/xlr_vector.html">xlr_vector()</a></code> a general type to format data nicely
without specific rules.</p></li>
</ul>
<p>All of the above variables contain the argument
<code>xlr_format</code> which only takes a <code><a href="../reference/xlr_format.html">xlr_format()</a></code>
object. <code><a href="../reference/xlr_format.html">xlr_format()</a></code> allows you to control different
formatting options when the data is outputted to <code>Excel</code>, it
currently does not change how the data looks in console. You can change
the font size, colour, text position etc. with
<code><a href="../reference/xlr_format.html">xlr_format()</a></code>. See <code><a href="../reference/xlr_format.html">?xlr_format</a></code> for the full
range of options.</p>
<p>For <code><a href="../reference/xlr_numeric.html">xlr_numeric()</a></code> and <code><a href="../reference/xlr_percent.html">xlr_percent()</a></code> you can
also set the number of decimal places through setting
<code>dp=x</code>.</p>
</div>
<div class="section level4">
<h4 id="updatingformatting-columns">Updating/Formatting columns<a class="anchor" aria-label="anchor" href="#updatingformatting-columns"></a>
</h4>
<p>You can update the format of individual columns by using
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate</a></code> or base R by setting the column with new
formatting options:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xlr_table.html">xlr_table</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="st">"A clever title"</span>, <span class="st">"A useful footnote"</span><span class="op">)</span></span>
<span>             </span>
<span><span class="co"># Lets update the format of the mpg column so that it displays using 0 decimal places</span></span>
<span><span class="va">table</span><span class="op">$</span><span class="va">mpg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xlr_numeric.html">xlr_numeric</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">mpg</span>, dp <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># You can also use mutate to achieve the same thing, this is useful for</span></span>
<span><span class="co"># updating multiple columns either by using across or in a single statement</span></span>
<span><span class="va">table</span> <span class="op">&lt;-</span> <span class="va">table</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    mpg <span class="op">=</span> <span class="fu"><a href="../reference/xlr_numeric.html">xlr_numeric</a></span><span class="op">(</span><span class="va">mpg</span>, dp <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="co"># convert columns that are integers to xlr_integer type</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="va">vs</span><span class="op">:</span><span class="va">carb</span>, <span class="op">~</span> <span class="fu"><a href="../reference/xlr_integer.html">xlr_integer</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="dplyr-verbs">dplyr verbs<a class="anchor" aria-label="anchor" href="#dplyr-verbs"></a>
</h4>
<p>The <code><a href="../reference/xlr_table.html">xlr_table()</a></code> type is implemented to work with most
<code>dplyr</code> verbs to make working with the data as seamless as
possible. To find out more see <code><a href="../reference/xlr_and_dplyr.html">?xlr_and_dplyr</a></code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="writing-data-to-excel">Writing data to <code>Excel</code><a class="anchor" aria-label="anchor" href="#writing-data-to-excel"></a>
</h3>
<p>xlr makes writing data to <code>Excel</code> easy using the
<code><a href="../reference/write_xlsx.html">write_xlsx()</a></code> function. This function takes either a
<code>xlr_table</code>, <code>tibble</code> or <code>data.frame</code>.
Note when you output a single object you need to specify</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/write_xlsx.html">write_xlsx</a></span><span class="op">(</span><span class="va">mtcars</span>,</span>
<span>           file <span class="op">=</span> <span class="st">"example.xlsx"</span>,</span>
<span>           sheet_name <span class="op">=</span> <span class="st">"example_sheet"</span><span class="op">)</span></span></code></pre></div>
<p>The output looks like this in <code>Excel</code>:</p>
<div class="float">
<img src="img%2Fdata.frame_example.png" alt="Example of exporting a data.frame with write_xlsx, it shows a simple table in Excel."><div class="figcaption">Example of exporting a data.frame with
write_xlsx, it shows a simple table in <code>Excel</code>.</div>
</div>
<p>When you output a <code>xlr_table</code> with this function
additional formatting will be applied to the data as well as the title
and a footnote.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/write_xlsx.html">write_xlsx</a></span><span class="op">(</span><span class="va">table</span>,</span>
<span>           file <span class="op">=</span> <span class="st">"example.xlsx"</span>,</span>
<span>           sheet_name <span class="op">=</span> <span class="st">"example_sheet"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Appending file: <span style="color: #0000BB;">example.xlsx</span></span></span></code></pre></div>
<p>The output looks like this in <code>Excel</code>:</p>
<div class="float">
<img src="img%2Fxlr_table_example.png" alt="Example of using a xlr_table with write_xlsx, the table now has a table, footnote and formatting!"><div class="figcaption">Example of using a xlr_table with write_xlsx,
the table now has a table, footnote and formatting!</div>
</div>
<p>To update this formatting you either need to update the styles of the
columns using the above, or if you want to modify the style of the table
use <code>update_theme</code>. You can modify the the format of the
title, footnote, column heading or table body. The below example shows
how to update title colour to be red and the underlined:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_theme.html">update_theme</a></span><span class="op">(</span><span class="va">table</span>,</span>
<span>                      title_format <span class="op">=</span> <span class="fu"><a href="../reference/xlr_format.html">xlr_format</a></span><span class="op">(</span>font_colour <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                                                 text_style <span class="op">=</span> <span class="st">"underline"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write_xlsx.html">write_xlsx</a></span><span class="op">(</span><span class="va">table</span>,</span>
<span>           file <span class="op">=</span> <span class="st">"example.xlsx"</span>,</span>
<span>           sheet_name <span class="op">=</span> <span class="st">"example_sheet"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Appending file: <span style="color: #0000BB;">example.xlsx</span></span></span></code></pre></div>
<p>The output looks like this:</p>
<div class="float">
<img src="img%2Fupdate_theme_example.png" alt="Example of update theme in use, the title is red and underlined"><div class="figcaption">Example of update theme in use, the title is red
and underlined</div>
</div>
<p>See <code><a href="../reference/update_theme.html">?update_theme</a></code> for more details.</p>
<div class="section level4">
<h4 id="write_xlsx-and-list">
<code>write_xlsx()</code> and <code>list()</code><a class="anchor" aria-label="anchor" href="#write_xlsx-and-list"></a>
</h4>
<p>Like <code><a href="https://rdrr.io/pkg/openxlsx/man/write.xlsx.html" class="external-link">openxlsx::write.xlsx()</a></code> you can also pass a
<strong>named list</strong> to <code><a href="../reference/write_xlsx.html">write_xlsx()</a></code> and these will
be automatically created as sheets in the <code>Excel</code> file. If
you have a <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> of tables, set <code>TOC = TRUE</code> in
order to generate a table of contents for the <code>Excel</code> file.
This is particularly useful when you have a large number of tables.</p>
</div>
</div>
<div class="section level2">
<h2 id="putting-it-all-together">Putting it all together<a class="anchor" aria-label="anchor" href="#putting-it-all-together"></a>
</h2>
<p>Example of how you can use xlr to analyse a survey is below:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">output_list</span><span class="op">[[</span><span class="st">"gender"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="va">clothes_opinions</span>,</span>
<span>                                       <span class="va">gender2</span>,</span>
<span>                                       <span class="st">"Gender in clothes opinions survey"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">output_list</span><span class="op">[[</span><span class="st">"gender age"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="va">clothes_opinions</span>,</span>
<span>                                       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gender2</span>, <span class="va">age_group</span><span class="op">)</span>,</span>
<span>                                       <span class="st">"Gender by age in clothes opinions survey"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">output_list</span><span class="op">[[</span><span class="st">"gender age"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_table.html">build_table</a></span><span class="op">(</span><span class="va">clothes_opinions</span>,</span>
<span>                                       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gender2</span>, <span class="va">age_group</span><span class="op">)</span>,</span>
<span>                                       <span class="st">"Gender by age in clothes opinions survey"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">output_list</span><span class="op">[[</span><span class="st">"opinions"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_qtable.html">build_qtable</a></span><span class="op">(</span><span class="va">clothes_opinions</span>,</span>
<span>                                        <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"Q1"</span><span class="op">)</span>,</span>
<span>                                       table_title <span class="op">=</span> <span class="st">"Opinions on different clothing items"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sometimes it is neater to use the pipe operator on the data</span></span>
<span><span class="co"># This also allows auto completion in RStudio for variable names</span></span>
<span><span class="va">output_list</span><span class="op">[[</span><span class="st">"opinions gender"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">clothes_opinions</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/build_qtable.html">build_qtable</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"Q1"</span><span class="op">)</span>,</span>
<span>                  <span class="va">gender2</span>,</span>
<span>                 table_title <span class="op">=</span> <span class="st">"Opinions on different clothing items by gender2"</span>,</span>
<span>                 use_questions <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># now output the data, we turn on the option to generate a table of contents</span></span>
<span><span class="fu"><a href="../reference/write_xlsx.html">write_xlsx</a></span><span class="op">(</span><span class="va">output_list</span>,</span>
<span>           file <span class="op">=</span> <span class="st">"example2.xlsx"</span>,</span>
<span>           TOC <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicholas Hilderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
